# TC7230-exploit

This exploit uses the Cable Haunt vulnerability to open a shell for the Technicolor TC7230 (EB.01.25-160301-F-5FF) cable modem.

We have in cluded two ways of exploiting the modem in this repo, one just like the one for [sagemcom F@st](https://github.com/Lyrebirds/sagemcom-fast-3890-exploit). If you want to try out this attack the sagemcom repo, and replace reverseshell.c with the one from this repo, and do the same for the exploit.js in the static folder.

## DNS Rebind
The other attack that we will focus more on in this repo uses a DNS rebind attack ([CVE-2019-19495](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2019-19495)) to gain access to the web configuration of the tc7230. Using access to this web the script sets up port forwarding for the telnet server running on the linux side of TC7230, and from there exploiting cable Haunt to gain full control.

### running the exploit
To run this exploit install the required dependencies for running DNS.py and run it with sudo to serve on port tcp 80 and udp 53. This will serve a malicious webserver on port 80 and DNS server on udo port 53. Now to simulate owning the domain pwnmymodem.com we change the primary DNS server of the victims machine to the attackers ip. Remember to change the ip in DNS.py accordingly.

Now when the victim enters http://pwnmymodem.com the exploit will tricker after some time (around 2 minutes),
as the DNS cache of the victims browser has to be cleared before the exploit will execute. 